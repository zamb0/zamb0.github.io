{{- with .cxt}}
  {{- $isHidden := $.isHidden }}
  {{- $slug := .File.BaseFileName }}

  {{- /* Proviamo prima jpeg, poi png */ -}}
  {{- $possibleFormats := slice "jpeg" "jpg" "png" }}
  {{- $coverParam := "" }}
  {{- range $fmt := $possibleFormats }}
    {{- $testPath := printf "%s/%s-0.%s" $slug $slug $fmt }}
    {{- if fileExists (printf "static/images/%s" $testPath) }}
      {{- $coverParam = $testPath }}
      {{- break }}
    {{- end }}
  {{- end }}

  {{- /* Se non trovato, fallback a jpeg */ -}}
  {{- if eq $coverParam "" }}
    {{- $coverParam = printf "%s/%s-0.jpeg" $slug $slug }}
  {{- end }}

  {{- /* Log del path scelto */ -}}
  {{- /* warnf "Cover path per %s: %s" .Title $coverParam */}}

  {{- if (and (not $.IsSingle) (not $isHidden)) }}
    {{- $alt := (.Params.cover.alt | default .Params.cover.caption | default .Title | plainify) }}
    {{- $loading := cond $.IsSingle "eager" "lazy" }}

    <figure class="entry-cover left-cover">
      {{- $pageBundleCover := (.Resources.ByType "image").GetMatch (printf "*%s*" $coverParam) }}
      {{- $globalResourcesCover := (resources.ByType "image").GetMatch (printf "*%s*" $coverParam) }}
      {{- $cover := or $pageBundleCover $globalResourcesCover }}

      {{- if $cover }}
        <img loading="{{$loading}}" src="{{ $cover.Permalink }}" alt="{{ $alt }}" width="150" height="150">
      {{- else }}
        <img loading="{{$loading}}" src="/images/{{ $coverParam }}" alt="{{ $alt }}" width="150" height="150">
      {{- end }}
    </figure>
  {{- end }}
{{- end }}
